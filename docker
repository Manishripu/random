FROM eclipse-temurin:17-jre-alpine

WORKDIR /app

# Install curl & download Datadog agent
RUN apk add --no-cache curl \
 && curl -fL https://dtdg.co/latest-java-tracer -o /dd-java-agent.jar \
 && chmod 644 /dd-java-agent.jar

# Copy app
COPY target/app.jar app.jar

# Start app (Datadog agent attached)
ENTRYPOINT ["java", "-javaagent:/dd-java-agent.jar", "-jar", "app.jar"]